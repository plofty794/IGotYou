import{k as e,aa as S,j as u,u as I,ab as C}from"./index-6408ffe3.js";import{T as D,V as F,W as T,B as h,X as N,Y as $,Z as y,_ as P,a0 as R,a1 as B,a2 as L,a3 as j,a4 as M,a5 as A,a6 as U,D as _,a7 as O,p as Q,q as H,r as K,S as w,a8 as E,k as W,m as k,j as Y,a9 as G,u as V,aa as z,ab as X,ac as Z,ad as J,ae as ee,af as v,ag as f,ah as x,ai as o,aj as c,ak as p,al as se,am as te}from"./App-55b5641c.js";function ae({date:t,setDate:l}){const i=D("(max-width: 768px)");return e.jsxs(F,{children:[e.jsx(T,{className:"w-full p-6",asChild:!0,children:e.jsxs(h,{id:"date",variant:"outline",className:`
              w-full justify-center font-medium ${!t&&"text-muted-foreground"}
              
            `,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[N(t.from,"LLL dd, y")," -"," ",N(t.to,"LLL dd, y")]}):N(t.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx($,{className:"w-auto p-0",align:"start",children:i?e.jsx(y,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:l,numberOfMonths:1,fromYear:2024}):e.jsx(y,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:l,numberOfMonths:2,fromYear:2024})})]})}function le({setBookingRequestStatus:t}){return e.jsxs(P,{onValueChange:l=>t(l),children:[e.jsx(R,{className:"w-full",children:e.jsx(B,{placeholder:"Status"})}),e.jsxs(L,{children:[e.jsx(j,{value:"pending",children:"Pending"}),e.jsx(j,{value:"approved",children:"Approved"}),e.jsx(j,{value:"declined",children:"Declined"}),e.jsx(j,{value:"cancelled",children:"Cancelled"})]})]})}function re(){const[t,l]=u.useState({from:new Date,to:M(new Date,10)}),[i,r]=u.useState(""),n=A(),m=U();return e.jsxs(_,{onOpenChange:d=>{d||(l({from:void 0,to:void 0}),r(""))},children:[e.jsx(O,{asChild:!0,children:e.jsx(h,{className:"rounded-full p-2 max-lg:w-full",variant:"outline",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-6 w-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})})})}),e.jsxs(Q,{children:[e.jsx(H,{children:e.jsx(K,{className:"text-center",children:"Filters"})}),e.jsxs("div",{className:"flex flex-col gap-4 p-8 px-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Type of booking request"}),e.jsx(le,{setBookingRequestStatus:r}),e.jsx(w,{}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Date range"}),e.jsx("p",{className:"text-sm font-medium",children:"Booking request dates"}),e.jsx(ae,{date:t,setDate:l})]})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx(h,{variant:"outline",onClick:()=>{l({from:void 0,to:void 0}),r(""),n[1](""),setTimeout(()=>document.location.reload(),200)},children:"Clear all"}),e.jsx(h,{disabled:!i||!(t!=null&&t.from)||!t.to,onClick:()=>{const d=E([["status",i],["dateFrom",t.from.toDateString()],["dateTo",t.to.toDateString()]]);n[1](d.toString()),m(`/hosting-inbox/${location.search}`),setTimeout(()=>document.location.reload(),200)},className:"bg-gray-950",children:"Save filter"})]})]})]})}function ne(){var r;const t=location.search?location.search.split("?")[1].split("&")[0].split("=")[1]:"",l=location.search?location.search.split("?")[1].split("&")[1].split("=")[1].split("+").join(" "):"",i=location.search?location.search.split("?")[1].split("&")[2].split("=")[1].split("+").join(" "):"";return W({queryKey:["host-booking-requests"],queryFn:async({pageParam:n})=>k.get(`/api/host-booking-requests/${n}`,{params:{status:t,requestedBookingDateStartsAt:l,requestedBookingDateEndsAt:i}}),getNextPageParam:(n,m)=>m.length+1,initialPageParam:1,enabled:((r=Y.currentUser)==null?void 0:r.uid)!=null,refetchOnWindowFocus:!1})}function ie(t){return G({queryKey:["guest",t],queryFn:async()=>k.get(`/api/search-guest/${t}`),enabled:t!=="",refetchOnMount:!1,refetchOnWindowFocus:!1})}function ce(){var b;const t=D("(max-width: 915px)"),l=I(),{id:i}=V(),{data:r}=ne(),[n,m]=u.useState(""),d=ie(n),g=u.useMemo(()=>{var s;return n?(s=d.data)==null?void 0:s.data.guestNames:[]},[n,(b=d.data)==null?void 0:b.data.guestNames]);return u.useEffect(()=>{document.title="Host Inbox - IGotYou"},[]),e.jsxs("section",{className:"flex gap-4 p-4",children:[e.jsxs("div",{className:"flex w-1/3 flex-col gap-2",children:[e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("h1",{className:"gap-2 text-2xl font-bold max-md:hidden max-md:text-lg",children:"Booking requests"}),e.jsx(z,{children:e.jsxs(X,{children:[e.jsx(Z,{className:"max-md:w-full",asChild:!0,children:e.jsx(h,{onClick:()=>{l.invalidateQueries({queryKey:["host-booking-requests"]}),l.invalidateQueries({queryKey:["booking-request"],exact:!1}),l.invalidateQueries({queryKey:["host-notifications"],exact:!1})},size:"sm",className:"rounded-full",variant:"outline",children:e.jsx(C,{className:"h-4 w-4"})})}),e.jsx(J,{children:e.jsx("p",{className:"text-xs font-medium",children:"Reload requests"})})]})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between gap-2 max-lg:flex-col",children:[e.jsx(ee,{value:n,onChange:s=>m(s.target.value),placeholder:"Search guest name...",className:"w-full font-medium"}),e.jsx(re,{})]}),(g==null?void 0:g.length)>0?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mt-2 h-max max-h-[484px]",children:e.jsx("div",{className:"inbox mt-2 flex w-full flex-col gap-4 max-md:gap-2",children:g.map(s=>s.type==="Service-Cancellation-Request"?e.jsx(f,{to:`/hosting-inbox/booking-request/${s._id}`,className:"rounded-md border font-bold text-gray-600 shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(x,{className:"max-sm:mx-auto",children:[e.jsx(o,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{children:[e.jsx(o,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:p(new Date(s.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic",children:s.message})}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]})]})})},s._id):e.jsx(f,{to:`/hosting-inbox/booking-request/${s._id}`,className:"rounded-md border font-bold text-gray-600 shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(x,{className:"max-sm:mx-auto",children:[e.jsx(o,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{children:[e.jsx(o,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:p(new Date(s.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic",children:s.message})}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]})]})})},s._id))})}),e.jsx(w,{})]}):r==null?void 0:r.pages.flatMap(s=>s.data.bookingRequests.length>0?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mt-2 h-max max-h-[484px]",children:e.jsx("div",{className:"inbox mt-2 flex w-full flex-col gap-4 max-md:gap-2",children:r==null?void 0:r.pages.flatMap(q=>q.data.bookingRequests.map(a=>a.type==="Service-Cancellation-Request"?e.jsx(f,{to:`/hosting-inbox/booking-request/${a._id}`,className:"rounded-md border font-bold shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(x,{className:"max-sm:mx-auto",children:[e.jsx(o,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{children:[e.jsx(o,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:p(new Date(a.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic",children:a.message})}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]})]})})},a._id):e.jsx(f,{to:`/hosting-inbox/booking-request/${a._id}`,className:"rounded-md border font-bold text-gray-600 shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(x,{className:"max-sm:mx-auto",children:[e.jsx(o,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{children:[e.jsx(o,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:p(new Date(a.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic",children:a.message})}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]})]})})},a._id)))})}),e.jsx(w,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{to:"/hosting-inbox",replace:!0}),e.jsx("div",{className:"p-4",children:e.jsx("p",{className:"text-center text-lg font-semibold text-gray-600",children:"No booking requests"})})]}))]}),e.jsx("div",{className:"w-full",children:i?e.jsx(te,{}):e.jsxs("div",{className:"flex min-h-[70vh] w-full flex-col items-center justify-center p-8",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"This is your Booking Requests page."}),e.jsx("p",{className:"text-lg font-medium text-gray-600",children:"Select a booking request to be shown here."})]})})]})}export{ce as default};
