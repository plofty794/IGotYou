import{k as e,aa as S,j as m,u as I,ab as C}from"./index-5b981149.js";import{T as D,V as F,W as R,B as u,X as p,Y as B,Z as y,_ as T,a0 as $,a1 as P,a2 as L,a3 as g,a4 as M,a5 as A,D as H,a6 as U,p as _,q as Q,r as O,S as N,a7 as K,k as E,m as k,j as W,a8 as Y,u as G,a9 as V,aa as z,ab as X,ac as Z,ad as J,ae as v,af as j,ag as o,ah as x,ai as c,aj as f,ak as ee,al as se}from"./App-e4380d2b.js";function te({date:t,setDate:l}){const i=D("(max-width: 768px)");return e.jsxs(F,{children:[e.jsx(R,{className:"w-full p-6",asChild:!0,children:e.jsxs(u,{id:"date",variant:"outline",className:`
              w-full justify-center font-medium ${!t&&"text-muted-foreground"}
              
            `,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[p(t.from,"LLL dd, y")," -"," ",p(t.to,"LLL dd, y")]}):p(t.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(B,{className:"w-auto p-0",align:"start",children:i?e.jsx(y,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:l,numberOfMonths:1,fromYear:2024}):e.jsx(y,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:l,numberOfMonths:2,fromYear:2024})})]})}function ae({setBookingRequestStatus:t}){return e.jsxs(T,{onValueChange:l=>t(l),children:[e.jsx($,{className:"w-full",children:e.jsx(P,{placeholder:"Status"})}),e.jsxs(L,{children:[e.jsx(g,{value:"pending",children:"Pending"}),e.jsx(g,{value:"approved",children:"Approved"}),e.jsx(g,{value:"declined",children:"Declined"}),e.jsx(g,{value:"cancelled",children:"Cancelled"})]})]})}function le(){const[t,l]=m.useState({from:new Date,to:M(new Date,10)}),[i,r]=m.useState(""),n=A();return e.jsxs(H,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(u,{className:`rounded-full p-2 max-lg:w-full ${localStorage.getItem("hasHostBookingRequestFilter")?"relative animate-bounce outline outline-2":""}`,variant:"outline",children:[localStorage.getItem("hasHostBookingRequestFilter")&&e.jsx("span",{className:"absolute right-0 top-0 h-2 w-2 rounded-full bg-red-500"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-6 w-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})})]})}),e.jsxs(_,{children:[e.jsx(Q,{children:e.jsx(O,{className:"text-center",children:"Filters"})}),e.jsxs("div",{className:"flex flex-col gap-4 p-8 px-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Type of booking request"}),e.jsx(ae,{setBookingRequestStatus:r}),e.jsx(N,{}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Date range"}),e.jsx("p",{className:"text-sm font-medium",children:"Booking request dates"}),e.jsx(te,{date:t,setDate:l})]})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx(u,{disabled:localStorage.getItem("hasHostBookingRequestFilter")==null,variant:"outline",onClick:()=>{l({from:void 0,to:void 0}),setTimeout(()=>document.location.reload(),200),r(""),n[1](""),localStorage.removeItem("hasHostBookingRequestFilter")},children:"Clear all"}),e.jsx(u,{disabled:!i||!(t!=null&&t.from)||!t.to,onClick:()=>{const d=K([["status",i],["dateFrom",t.from.toDateString()],["dateTo",t.to.toDateString()]]);setTimeout(()=>document.location.reload(),200),n[1](d.toString()),localStorage.setItem("hasHostBookingRequestFilter","true")},className:"bg-gray-950",children:"Save filter"})]})]})]})}function re(){var r;const t=location.search?location.search.split("?")[1].split("&")[0].split("=")[1]:"",l=location.search?location.search.split("?")[1].split("&")[1].split("=")[1].split("+").join(" "):"",i=location.search?location.search.split("?")[1].split("&")[2].split("=")[1].split("+").join(" "):"";return E({queryKey:["host-booking-requests"],queryFn:async({pageParam:n})=>k.get(`/api/host-booking-requests/${n}`,{params:{status:t,requestedBookingDateStartsAt:l,requestedBookingDateEndsAt:i}}),getNextPageParam:(n,d)=>d.length+1,initialPageParam:1,enabled:((r=W.currentUser)==null?void 0:r.uid)!=null,refetchOnWindowFocus:!1})}function ne(t){return Y({queryKey:["guest",t],queryFn:async()=>k.get(`/api/search-guest/${t}`),enabled:t!=="",refetchOnMount:!1,refetchOnWindowFocus:!1})}function xe(){var b;const t=D("(max-width: 915px)"),l=I(),{id:i}=G(),{data:r}=re(),[n,d]=m.useState(""),w=ne(n),h=m.useMemo(()=>{var s;return n?(s=w.data)==null?void 0:s.data.guestNames:[]},[n,(b=w.data)==null?void 0:b.data.guestNames]);return m.useEffect(()=>{document.title="Host Inbox - IGotYou"},[]),e.jsxs("section",{className:"flex gap-4 p-4",children:[e.jsxs("div",{className:"flex w-1/3 flex-col gap-2",children:[e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("h1",{className:"gap-2 text-2xl font-bold max-md:hidden max-md:text-lg",children:"Booking requests"}),e.jsx(V,{children:e.jsxs(z,{children:[e.jsx(X,{className:"max-md:w-full",asChild:!0,children:e.jsx(u,{onClick:()=>{l.invalidateQueries({queryKey:["host-booking-requests"]}),l.invalidateQueries({queryKey:["booking-request"],exact:!1}),l.invalidateQueries({queryKey:["host-notifications"],exact:!1})},size:"sm",className:"rounded-full",variant:"outline",children:e.jsx(C,{className:"h-4 w-4"})})}),e.jsx(Z,{children:e.jsx("p",{className:"text-xs font-medium",children:"Reload requests"})})]})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between gap-2 max-lg:flex-col",children:[e.jsx(J,{value:n,onChange:s=>d(s.target.value),placeholder:"Search guest name...",className:"w-full font-medium"}),e.jsx(le,{})]}),(h==null?void 0:h.length)>0?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mt-2 h-max max-h-[484px]",children:e.jsx("div",{className:"inbox mt-2 flex w-full flex-col gap-4 max-md:gap-2",children:h.map(s=>s.type=="Service-Cancellation-Request"?e.jsx(j,{to:`/hosting-inbox/booking-request/${s._id}`,className:"rounded-md border font-bold text-gray-600 shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"max-sm:mx-auto",children:[e.jsx(x,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[e.jsx(x,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:f(new Date(s.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic text-red-600",children:s.type.split("-").join(" ")})}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]})]})})},s._id):e.jsx(j,{to:`/hosting-inbox/booking-request/${s._id}`,className:"rounded-md border font-bold text-gray-600 shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"max-sm:mx-auto",children:[e.jsx(x,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[e.jsx(x,{className:"object-cover",src:s.guestID.photoUrl,alt:s.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:s.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:f(new Date(s.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic",children:s.message})}),e.jsx("span",{className:` ${s.status==="pending"?"text-amber-600 hover:text-amber-500":s.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:s.status})]})]})]})})},s._id))})}),e.jsx(N,{})]}):r==null?void 0:r.pages.flatMap(s=>s.data.bookingRequests.length>0?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mt-2 h-max max-h-[484px]",children:e.jsx("div",{className:"inbox mt-2 flex w-full flex-col gap-4 max-md:gap-2",children:r==null?void 0:r.pages.flatMap(q=>q.data.bookingRequests.map(a=>a.type==="Service-Cancellation-Request"?e.jsx(j,{to:`/hosting-inbox/booking-request/${a._id}`,className:"rounded-md border font-bold shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"max-sm:mx-auto",children:[e.jsx(x,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[e.jsx(x,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:f(new Date(a.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic text-red-600",children:a.type.split("-").join(" ")})}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]})]})})},a._id):e.jsx(j,{to:`/hosting-inbox/booking-request/${a._id}`,className:"rounded-md border font-bold text-gray-600 shadow-md",children:e.jsx("div",{className:"flex gap-2 px-4 py-2 max-lg:p-2",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"max-sm:mx-auto",children:[e.jsx(x,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 max-sm:hidden",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[e.jsx(x,{className:"object-cover",src:a.guestID.photoUrl,alt:a.guestID.username}),e.jsx(c,{children:"CN"})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex w-full items-start justify-between",children:[e.jsx("span",{className:"text-xs",children:a.guestID.username}),e.jsx("span",{className:"text-xs text-gray-600",children:f(new Date(a.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"w-44 overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"max-w-xs text-xs italic",children:a.message})}),e.jsx("span",{className:` ${a.status==="pending"?"text-amber-600 hover:text-amber-500":a.status==="approved"?"text-green-600 hover:text-green-500":"text-red-600 hover:text-red-500"}  w-max text-xs font-extrabold`,children:a.status})]})]})]})})},a._id)))})}),e.jsx(N,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{to:"/hosting-inbox",replace:!0}),e.jsx("div",{className:"p-4",children:e.jsx("p",{className:"text-center text-lg font-semibold text-gray-600",children:"No booking requests"})})]}))]}),e.jsx("div",{className:"w-full",children:i?e.jsx(se,{}):e.jsxs("div",{className:"flex min-h-[70vh] w-full flex-col items-center justify-center p-8",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"This is your Booking Requests page."}),e.jsx("p",{className:"text-lg font-medium text-gray-600",children:"Select a booking request to be shown here."})]})})]})}export{xe as default};
